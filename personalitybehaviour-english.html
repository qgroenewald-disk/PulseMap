<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PulseMap Personality Behaviour Analysis</title>
    <meta property="og:title" content="PulseMap Personality Behaviour Analysis">
    <meta property="og:description" content="Discover your personality type with our PulseMap questionnaire.">
    <meta property="og:image" content="https://i.imgur.com/Zx34Iky.png">
    <meta property="og:url" content="https://qgroenewald-disk.github.io/mbti-analise/">
    <meta property="og:type" content="website">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for Inter font */
        body {
            font-family: 'Poppins', sans-serif; /* Changed to Poppins for consistency with Funksioneringstyl */
            background-color: var(--secondary-color); /* Added for consistency */
            color: var(--text-color); /* Added for consistency */
            line-height: 1.6; /* Added for consistency */
            margin: 0; /* Added for consistency */
            padding: 20px; /* Added for consistency */
        }
        /* Define CSS variables for consistent theming */
        :root {
            --primary-color: #005A9C; /* Matching the primary color from Funksioneringstyl Assessment */
            --secondary-color: #f4f4f9;
            --text-color: #333;
            --border-color: #ddd;
            --error-color: #D8000C;
            --success-color: #4F8A10;
        }

        /* Import Poppins font */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

        /* General Body Styles */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* Container Styling */
        .container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Headings */
        h1, h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600;
        }

        /* Intro Text */
        .intro-text {
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.8;
            color: #555;
            font-size: 1.05em;
        }

        /* Form Group (for name/email) */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-group input[type="text"],
        .form-group input[type="email"] {
            width: calc(100% - 20px);
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="email"]:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        /* Questions Container */
        #questionsContainer {
            margin-top: 30px;
        }

        /* Question Card */
        .question-card {
            background-color: #f9f9f9;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .question-card p {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-size: 1.15em;
            line-height: 1.5;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        /* Option Button */
        .option-button {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            padding: 12px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            text-align: left;
            transition: all 0.3s ease;
            color: #495057;
            display: flex;
            align-items: center;
            line-height: 1.4;
        }

        .option-button:hover {
            background-color: #dee2e6;
            border-color: #adb5bd;
        }

        .option-button.selected {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            transform: translateY(-2px);
        }

        /* Button Group */
        .button-group {
            text-align: center;
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .button-group button {
            background-color: var(--primary-color);
            color: #fff;
            padding: 14px 30px;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-weight: 600;
            flex-grow: 1;
            max-width: 300px;
        }

        .button-group button:hover:not(:disabled) {
            background-color: #004a80;
            transform: translateY(-2px);
        }

        .button-group button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Results Section */
        .results-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            text-align: center;
        }

        .results-section h2 {
            margin-bottom: 20px;
        }

        #mbtiResultDisplay {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .style-description {
            background-color: #f0f8ff;
            border: 1px solid #cceeff;
            border-radius: 8px;
            padding: 20px;
            text-align: left;
            margin-top: 20px;
            line-height: 1.7;
            font-size: 0.95em;
            color: #444;
        }

        .submission-message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }
        .email-success {
            background-color: #DFF2BF;
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }
        .email-error {
            background-color: #FFBABA;
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }
        .email-info {
            background-color: #cce5ff;
            color: #004085;
            border: 1px solid #b8daff;
        }

        .hidden {
            display: none;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                margin: 10px auto;
                padding: 20px;
            }
            .options-grid {
                grid-template-columns: 1fr;
            }
            .button-group {
                flex-direction: column;
                gap: 15px;
            }
            .button-group button {
                max-width: 100%;
            }
        }
    </style>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        emailjs.init({
            publicKey: "rES387Z_beB0IEiRm",
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>PulseMap Personality Behaviour Analysis</h1>
        <p class="intro-text">
            This assessment helps you discover your personality type based on your preferences in different areas. Please answer each question honestly to get the most accurate results.
        </p>

        <form id="personality-form">
            <div class="mb-6">
                <label for="userName" class="block text-gray-700 text-sm font-bold mb-2">Your Name:</label>
                <input type="text" id="userName" name="userName" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
            </div>
            <div class="mb-6">
                <label for="userEmail" class="block text-gray-700 text-sm font-bold mb-2">Your Email:</label>
                <input type="email" id="userEmail" name="userEmail" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
            </div>

            <div id="questionsContainer">
                </div>

            <div class="button-group">
                <button type="button" id="backButton" class="hidden">Back</button>
                <button type="submit" id="submitBtn">Calculate Results</button>
            </div>
            <p id="submissionMessage" class="submission-message hidden"></p>
        </form>

        <div id="resultsContainer" class="results-section hidden">
            <h2>Your Personality Type:</h2>
            <p id="mbtiResultDisplay"></p>
            <div id="personalityDescription" class="style-description">
                </div>
        </div>
    </div>

    <script>
        const questionsData = [
            {
                "id": "e_i",
                "question": "When at a party, are you:",
                "options": [
                    {"text": "Mostly quiet and reserved", "value": "I"},
                    {"text": "Talkative and outgoing", "value": "E"}
                ]
            },
            {
                "id": "s_n",
                "question": "Are you more interested in:",
                "options": [
                    {"text": "The practical and realistic aspects of life", "value": "S"},
                    {"text": "New ideas and possibilities", "value": "N"}
                ]
            },
            {
                "id": "t_f",
                "question": "When making decisions, do you tend to be:",
                "options": [
                    {"text": "Logical and objective", "value": "T"},
                    {"text": "Empathetic and considerate of others' feelings", "value": "F"}
                ]
            },
            {
                "id": "j_p",
                "question": "Do you prefer to:",
                "options": [
                    {"text": "Have things settled and organized", "value": "J"},
                    {"text": "Keep your options open and be flexible", "value": "P"}
                ]
            },
            {
                "id": "e_i2",
                "question": "After a social gathering, do you usually feel:",
                "options": [
                    {"text": "Energized and ready for more", "value": "E"},
                    {"text": "Drained and in need of alone time", "value": "I"}
                ]
            },
            {
                "id": "s_n2",
                "question": "Which describes you better:",
                "options": [
                    {"text": "Focus on the present and what is real", "value": "S"},
                    {"text": "Think about future possibilities and abstract concepts", "value": "N"}
                ]
            },
            {
                "id": "t_f2",
                "question": "When you have to give constructive criticism, are you:",
                "options": [
                    {"text": "Direct and fact-based", "value": "T"},
                    {"text": "Gentle and focused on preserving harmony", "value": "F"}
                ]
            },
            {
                "id": "j_p2",
                "question": "Is your natural state to be:",
                "options": [
                    {"text": "Planned and structured", "value": "J"},
                    {"text": "Spontaneous and adaptable", "value": "P"}
                ]
            }
        ];

        const resultsDescriptions = {
            "ISTJ": "Practical, factual, and logical. They are responsible and organized, preferring clear guidelines and traditions.",
            "ISFJ": "Warm, considerate, and conscientious. They are detail-oriented and committed to their responsibilities.",
            "INFJ": "Insightful, empathetic, and organized. They are visionaries who care deeply about others and have strong values.",
            "INTJ": "Strategic, independent, and logical. They are driven by a need for competence and innovation.",
            "ISTP": "Practical, observant, and spontaneous. They are hands-on problem-solvers who enjoy exploring how things work.",
            "ISFP": "Gentle, artistic, and adaptable. They live in the present and appreciate beauty and sensory experiences.",
            "INFP": "Idealistic, creative, and compassionate. They are driven by their values and seek meaning in life.",
            "INTP": "Analytical, curious, and innovative. They are logical problem-solvers who love theoretical concepts and abstract ideas.",
            "ESTP": "Energetic, practical, and action-oriented. They are daring and thrive in dynamic environments.",
            "ESFP": "Outgoing, spontaneous, and fun-loving. They enjoy being the center of attention and living in the moment.",
            "ENFP": "Enthusiastic, creative, and sociable. They are inspiring and enjoy exploring new ideas and possibilities.",
            "ENTP": "Innovative, curious, and quick-witted. They enjoy debating and challenging established norms.",
            "ESTJ": "Organized, decisive, and traditional. They are natural leaders who value efficiency and structure.",
            "ESFJ": "Warm, cooperative, and popular. They are practical and focused on helping others and maintaining social harmony.",
            "ENFJ": "Charismatic, empathetic, and inspiring. They are natural leaders who are passionate about helping others grow.",
            "ENTJ": "Commanding, strategic, and efficient. They are natural leaders who enjoy organizing and directing people."
        };

        let selectedAnswers = {};
        let currentQuestionIndex = 0;

        const form = document.getElementById('personality-form');
        const questionsContainer = document.getElementById('questionsContainer');
        const submitBtn = document.getElementById('submitBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const mbtiResultDisplay = document.getElementById('mbtiResultDisplay');
        const personalityDescription = document.getElementById('personalityDescription');
        const backButton = document.getElementById('backButton');
        const submissionMessage = document.getElementById('submissionMessage');


        function showSubmissionMessage(message, type) {
            submissionMessage.textContent = message;
            submissionMessage.className = `submission-message ${type ? `email-${type}` : ''}`;
            submissionMessage.classList.remove('hidden');
        }

        function renderQuestions() {
            questionsContainer.innerHTML = ''; // Clear previous questions
            if (currentQuestionIndex < questionsData.length) {
                const q = questionsData[currentQuestionIndex];
                const questionCard = document.createElement('div');
                questionCard.classList.add('question-card');
                questionCard.innerHTML = `
                    <p>${currentQuestionIndex + 1}. ${q.question}</p>
                    <div class="options-grid">
                        ${q.options.map(option => `
                            <button type="button" class="option-button" data-value="${option.value}">
                                ${option.text}
                            </button>
                        `).join('')}
                    </div>
                `;
                questionsContainer.appendChild(questionCard);

                // Highlight previously selected answer if exists
                if (selectedAnswers[q.id]) {
                    questionCard.querySelector(`button[data-value="${selectedAnswers[q.id]}"]`).classList.add('selected');
                }

                questionCard.querySelectorAll('.option-button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        // Deselect any previously selected button in this question
                        questionCard.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
                        // Select the clicked button
                        event.target.classList.add('selected');
                        selectedAnswers[q.id] = event.target.dataset.value;

                        // Automatically move to the next question
                        setTimeout(() => {
                            if (currentQuestionIndex < questionsData.length - 1) {
                                currentQuestionIndex++;
                                renderQuestions();
                                backButton.classList.remove('hidden');
                            } else {
                                submitBtn.classList.remove('hidden');
                            }
                        }, 300); // Small delay for visual feedback
                    });
                });
            } else {
                // All questions displayed, show submit button
                submitBtn.classList.remove('hidden');
            }
            updateNavigationButtons();
        }

        function updateNavigationButtons() {
            if (currentQuestionIndex > 0) {
                backButton.classList.remove('hidden');
            } else {
                backButton.classList.add('hidden');
            }
            if (currentQuestionIndex === questionsData.length) {
                submitBtn.classList.remove('hidden');
            } else {
                submitBtn.classList.add('hidden');
            }
        }

        backButton.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestions();
            }
        });


        function calculatePersonality(answers) {
            let counts = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            for (const key in answers) {
                const type = answers[key];
                if (counts.hasOwnProperty(type)) {
                    counts[type]++;
                }
            }

            let personalityType = "";
            personalityType += (counts.E >= counts.I) ? "E" : "I";
            personalityType += (counts.S >= counts.N) ? "S" : "N";
            personalityType += (counts.T >= counts.F) ? "T" : "F";
            personalityType += (counts.J >= counts.P) ? "J" : "P";

            return { personalityType: personalityType, counts: counts };
        }

        form.addEventListener('submit', async (event) => {
            event.preventDefault();

            const userName = document.getElementById('userName').value;
            const userEmail = document.getElementById('userEmail').value;

            if (!userName || !userEmail) {
                showSubmissionMessage("Please fill in your name and email.", 'error');
                return;
            }

            if (Object.keys(selectedAnswers).length !== questionsData.length) {
                showSubmissionMessage('Please answer all questions before calculating results.', 'error');
                return;
            }

            const { personalityType } = calculatePersonality(selectedAnswers);

            submitBtn.disabled = true;
            submitBtn.textContent = "Submitting...";
            showSubmissionMessage("Your results are being submitted...", 'info');

            const templateParams = {
                client_name: userName, // Changed 'user_name' to 'client_name'
                personality_result: personalityType
            };

            try {
                const response = await emailjs.send('service_b087h4p', 'template_n84drg8', templateParams);
                console.log('Email sent successfully!', response.status, response.text);
                showSubmissionMessage('Your results have been submitted successfully!', 'success');
                
                // Update results display
                mbtiResultDisplay.textContent = personalityType;
                personalityDescription.textContent = resultsDescriptions[personalityType] || "No description available.";
                resultsContainer.classList.remove('hidden');

                // Hide form elements
                document.getElementById('userName').closest('.mb-6').classList.add('hidden'); // Hide the name input group
                document.getElementById('userEmail').closest('.mb-6').classList.add('hidden'); // Hide the email input group
                questionsContainer.classList.add('hidden');
                submitBtn.classList.add('hidden');
                backButton.classList.remove('hidden');

            } catch (error) {
                console.error('Failed to send email:', error);
                showSubmissionMessage('Error: Could not submit results. Please try again.', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = "Calculate Results";
            }
        });

        document.addEventListener('DOMContentLoaded', renderQuestions);
    </script>
</body>
</html>
