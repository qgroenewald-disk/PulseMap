<!DOCTYPE html>
<html lang="af">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PulseMap Funksioneringstyl Analise</title>
    <link rel="icon" href="https://i.imgur.com/Zx34Iky.png" type="image/png">
    <meta property="og:title" content="PulseMap Funksioneringstyl Analise">
    <meta property="og:description" content="Voltooi jou PulseMap Funksioneringstyl analise en sien jou resultate.">
    <meta property="og:image" content="https://i.imgur.com/Zx34Iky.png">
    <meta property="og:url" content="https://qgroenewald-disk.github.io/Disk-Analise-Vorm/">
    <meta property="og:type" content="website">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
        :root {
            --primary-color: #005A9C;
            --secondary-color: #f4f4f9;
            --text-color: #333;
            --border-color: #ddd;
            --error-color: #D8000C;
            --success-color: #4F8A10;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
        }
        .intro-text, .results-description {
            text-align: center;
            margin-bottom: 25px;
            line-height: 1.8;
            color: #555;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        .form-group input[type="text"],
        .form-group input[type="email"] {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .question-card {
            background-color: #f9f9f9;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
        }
        .question-card p {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-size: 1.1em;
        }
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
        }
        .option-button {
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            padding: 12px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95em;
            text-align: center;
            transition: all 0.3s ease;
            color: #444;
        }
        .option-button:hover {
            background-color: #d0d0d0;
            border-color: #bbb;
        }
        .option-button.selected {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        .button-group {
            text-align: center;
            margin-top: 30px;
        }
        .button-group button {
            background-color: var(--primary-color);
            color: #fff;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-weight: 600;
            margin: 0 10px;
        }
        .button-group button:hover:not(:disabled) {
            background-color: #004a80;
            transform: translateY(-2px);
        }
        .button-group button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .results-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            text-align: center;
        }
        .results-scores {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        .score-item {
            background-color: #e6f2ff;
            border: 1px solid #cce0ff;
            border-radius: 8px;
            padding: 15px 25px;
            text-align: center;
            min-width: 120px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .score-item h3 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1.2em;
        }
        .score-item p {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin: 5px 0 0;
        }
        .style-description {
            background-color: #f0f8ff;
            border: 1px solid #cceeff;
            border-radius: 8px;
            padding: 20px;
            text-align: left;
            margin-top: 20px;
            line-height: 1.7;
            font-size: 0.95em;
            color: #444;
        }
        .submission-message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }
        .email-success {
            background-color: #DFF2BF;
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }
        .email-error {
            background-color: #FFBABA;
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }
        .email-info {
            background-color: #cce5ff;
            color: #004085;
            border: 1px solid #b8daff;
        }
        .hidden {
            display: none;
        }

        @media (max-width: 600px) {
            .container {
                margin: 10px auto;
                padding: 15px;
            }
            .options-grid {
                grid-template-columns: 1fr;
            }
            .button-group button {
                width: 100%;
                margin: 10px 0;
            }
        }
    </style>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        emailjs.init({
            publicKey: "rES387Z_beB0IEiRm",
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>PulseMap Funksioneringstyl Analise</h1>
        <p class="intro-text">
            Hierdie assessering help jou om jou natuurlike funksioneringstyl te verstaan. Lees elke stelling sorgvuldig en kies die opsie wat jou die beste beskryf. Daar is geen regte of verkeerde antwoorde nie, net eerlike refleksies.
        </p>

        <form id="disc-form">
            <div class="form-group">
                <label for="userName">Jou Naam:</label>
                <input type="text" id="userName" name="userName" required>
            </div>
            <div class="form-group">
                <label for="userEmail">Jou E-pos:</label>
                <input type="email" id="userEmail" name="userEmail" required>
            </div>

            <div id="questionsContainer">
                </div>

            <div class="button-group">
                <button type="button" id="backButton" class="hidden">Terug</button>
                <button type="submit" id="submitBtn">Dien in en Sien Resultate</button>
            </div>
            <p id="submissionMessage" class="submission-message hidden"></p>
        </form>

        <div id="resultsContainer" class="results-section hidden">
            <h2>Jou Funksioneringstyl Resultate</h2>
            <div class="results-scores">
                <div class="score-item">
                    <h3>Dominansie (D)</h3>
                    <p id="dScore">0</p>
                </div>
                <div class="score-item">
                    <h3>Invloed (I)</h3>
                    <p id="iScore">0</p>
                </div>
                <div class="score-item">
                    <h3>Stabiliteit (S)</h3>
                    <p id="sScore">0</p>
                </div>
                <div class="score-item">
                    <h3>Noukeurigheid (C)</h3>
                    <p id="cScore">0</p>
                </div>
            </div>
            <div id="discStyleDescription" class="style-description">
                <p>Gebaseer op jou tellings, sal jou primêre funksioneringstyl en die eienskappe daarvan hier verskyn.</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('disc-form');
            const questionsContainer = document.getElementById('questionsContainer');
            const submitBtn = document.getElementById('submitBtn');
            const backButton = document.getElementById('backButton');
            const resultsContainer = document.getElementById('resultsContainer');
            const submissionMessage = document.getElementById('submissionMessage');
            let currentQuestionIndex = 0;
            let answers = {}; // Stores selected options for each question
            let questionsData = []; // To store questions fetched from JSON

            function showSubmissionMessage(message, type) {
                submissionMessage.textContent = message;
                submissionMessage.className = `submission-message ${type ? `email-${type}` : ''}`;
                submissionMessage.classList.remove('hidden');
            }

            // Fetch questions from JSON file
            fetch('functioning_style_questions.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    questionsData = data;
                    generateQuestions();
                })
                .catch(error => {
                    console.error('Error loading questions:', error);
                    questionsContainer.innerHTML = '<p style="color: red; text-align: center;">Fout met laai van vrae. Probeer asseblief later weer.</p>';
                    submitBtn.disabled = true;
                });

            function generateQuestions() {
                questionsContainer.innerHTML = ''; // Clear previous questions
                if (currentQuestionIndex < questionsData.length) {
                    const q = questionsData[currentQuestionIndex];
                    const questionCard = document.createElement('div');
                    questionCard.classList.add('question-card');
                    questionCard.innerHTML = `
                        <p>${currentQuestionIndex + 1}. ${q.question_af}</p>
                        <div class="options-grid">
                            ${q.options.map((option, index) => `
                                <button type="button" class="option-button" data-value="${option.value}" data-type="${option.type}">
                                    ${option.text_af}
                                </button>
                            `).join('')}
                        </div>
                    `;
                    questionsContainer.appendChild(questionCard);

                    // Add event listeners to option buttons
                    questionCard.querySelectorAll('.option-button').forEach(button => {
                        button.addEventListener('click', (event) => {
                            // Deselect any previously selected button in this question
                            questionCard.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
                            // Select the clicked button
                            event.target.classList.add('selected');
                            answers[currentQuestionIndex] = {
                                value: event.target.dataset.value,
                                type: event.target.dataset.type
                            };
                            // Automatically move to the next question
                            setTimeout(() => {
                                if (currentQuestionIndex < questionsData.length - 1) {
                                    currentQuestionIndex++;
                                    generateQuestions();
                                    backButton.classList.remove('hidden');
                                } else {
                                    // All questions answered
                                    submitBtn.classList.remove('hidden');
                                }
                            }, 300); // Small delay for visual feedback
                        });
                    });
                } else {
                    // All questions displayed, show submit button
                    submitBtn.classList.remove('hidden');
                }
                updateNavigationButtons();
            }

            function updateNavigationButtons() {
                if (currentQuestionIndex > 0) {
                    backButton.classList.remove('hidden');
                } else {
                    backButton.classList.add('hidden');
                }
                if (currentQuestionIndex === questionsData.length) {
                    submitBtn.classList.remove('hidden');
                } else {
                    submitBtn.classList.add('hidden');
                }
            }

            backButton.addEventListener('click', () => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    generateQuestions();
                }
            });

            function calculateScores() {
                let scores = { D: 0, I: 0, S: 0, C: 0 };
                Object.values(answers).forEach(answer => {
                    if (answer.type && scores.hasOwnProperty(answer.type)) {
                        scores[answer.type] += parseInt(answer.value);
                    }
                });
                return scores;
            }

            function getDiscStyleDescription(scores) {
                // Determine primary style
                let primaryStyle = '';
                let maxScore = -Infinity;

                for (const style in scores) {
                    if (scores[style] > maxScore) {
                        maxScore = scores[style];
                        primaryStyle = style;
                    }
                }

                let description = '';
                switch (primaryStyle) {
                    case 'D':
                        description = `
                            <h3>Dominansie (D) Styl Eienskappe:</h3>
                            <p>Individue met 'n hoë D-telling is dikwels direk, resultaat-georiënteerd en mededingend. Hulle geniet uitdagings en om die leiding te neem. Hulle is selfgeldend, beslissend en fokus daarop om doelwitte vinnig te bereik. Hulle waardeer bevoegdheid en aksie.</p>
                            <p><strong>Sterkpunte:</strong> Gedrewe, probleemoplosser, selfvertroue, neem inisiatief.</p>
                            <p><strong>Areas vir Ontwikkeling:</strong> Kan as ongeduldig, te direk, of veeleisend beskou word.</p>
                        `;
                        break;
                    case 'I':
                        description = `
                            <h3>Invloed (I) Styl Eienskappe:</h3>
                            <p>Individue met 'n hoë I-telling is uitgaande, entoesiasties en optimisties. Hulle geniet sosiale interaksie, om ander te oorreed, en word dikwels as charismaties beskou. Hulle floreer in positiewe omgewings en is uitstekend daarin om spanne te motiveer.</p>
                            <p><strong>Sterkpunte:</strong> Oorredend, gesellig, optimisties, bou verhoudings.</p>
                            <p><strong>Areas vir Ontwikkeling:</strong> Kan ongeorganiseerd, impulsief, of te veel op gewildheid fokus.</p>
                        `;
                        break;
                    case 'S':
                        description = `
                            <h3>Stabiliteit (S) Styl Eienskappe:</h3>
                            <p>Individue met 'n hoë S-telling is kalm, geduldig en goeie luisteraars. Hulle waardeer konsekwentheid, lojaliteit en 'n stabiele omgewing. Hulle is ondersteunende spanlede wat 'n voorspelbare pas en samewerkende werk verkies.</p>
                            <p><strong>Sterkpunte:</strong> Geduldig, lojaal, ondersteunend, betroubaar, goeie luisteraar.</p>
                            <p><strong>Areas vir Ontwikkeling:</strong> Kan weerstand bied teen verandering, besluiteloos wees, of te tegemoetkomend wees.</p>
                        `;
                        break;
                    case 'C':
                        description = `
                            <h3>Noukeurigheid (C) Styl Eienskappe:</h3>
                            <p>Individue met 'n hoë C-telling is analities, presies en sistematies. Hulle fokus op akkuraatheid, kwaliteit en besonderhede. Hulle hou by reëls en standaarde en word dikwels as logiese en objektiewe probleemoplossers gesien.</p>
                            <p><strong>Sterkpunte:</strong> Akkuraat, logies, detail-georiënteerd, hoë standaarde.</p>
                            <p><strong>Areas vir Ontwikkeling:</strong> Kan oorkrities wees, geneig wees tot analise-verlamming, of weerstand bied teen subjektiewe idees.</p>
                        `;
                        break;
                    default:
                        description = `<p>Voltooi die assessering om jou primêre funksioneringstyl te openbaar.</p>`;
                }
                return description;
            }

            async function handleSubmit(event) {
                event.preventDefault();

                const userName = document.getElementById('userName').value;
                const userEmail = document.getElementById('userEmail').value;

                if (!userName || !userEmail) {
                    showSubmissionMessage("Vul asseblief jou naam en e-pos in.", 'error');
                    return;
                }

                if (Object.keys(answers).length !== questionsData.length) {
                    showSubmissionMessage("Beantwoord asseblief alle vrae voordat jy indien.", 'error');
                    return;
                }

                const scores = calculateScores();
                document.getElementById('dScore').textContent = scores.D;
                document.getElementById('iScore').textContent = scores.I;
                document.getElementById('sScore').textContent = scores.S;
                document.getElementById('cScore').textContent = scores.C;
                document.getElementById('discStyleDescription').innerHTML = getDiscStyleDescription(scores);

                resultsContainer.classList.remove('hidden');
                form.classList.add('hidden'); // Hide the form after submission

                submitBtn.disabled = true;
                submitBtn.textContent = "Besig om in te dien...";
                showSubmissionMessage("Jou resultate word gestuur...", 'info');

                const templateParams = {
                    client_name: userName, // Changed 'name' to 'client_name'
                    d_score: scores.D,
                    i_score: scores.I,
                    s_score: scores.S,
                    c_score: scores.C
                };

                try {
                    const response = await emailjs.send('service_b087h4p', 'template_n84drg8', templateParams);
                    console.log('E-pos suksesvol gestuur!', response.status, response.text);
                    showSubmissionMessage('Jou resultate is suksesvol ingedien!', 'success');
                    // Reset form after successful submission
                    // form.reset(); // Don't reset if we want to show results
                    // questionsContainer.innerHTML = '';
                    // generateQuestions();
                    backButton.classList.remove('hidden'); // Keep back button visible
                    submitBtn.classList.add('hidden');
                } catch (error) {
                    console.error('Kon nie e-pos stuur nie:', error);
                    showSubmissionMessage('Fout: Kon nie resultate indien nie. Probeer asseblief weer.', 'error');
                    submitBtn.disabled = false;
                    submitBtn.textContent = "Dien in en Sien Resultate";
                }
            }

            // Initial call to generate questions
            // generateQuestions(); // Called after fetching questionsData
            form.addEventListener('submit', handleSubmit);
        });
    </script>
</body>
</html>
